<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Planet Hopper ‚Äì Solo Level 3</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- HUD -->
  <div id="hud" style="display:none">
    <div id="hud-left">
      <span class="player-badge red">P1</span> ‚Üê ‚Üí ‚Üë
      <span id="hud-p2-controls" style="display:none">
        &nbsp;&nbsp;&nbsp;
        <span class="player-badge blue">P2</span> A D W
      </span>
    </div>
    <div id="hud-right">
      <button id="restartBtn" onclick="returnToMenu()">‚Ü© Menu</button>
    </div>
  </div>

  <!-- GAME CANVAS -->
  <canvas id="gameCanvas" width="800" height="450"></canvas>

  <!-- WIN OVERLAY -->
  <div id="winOverlay" style="display:none">
    <div id="winBox">
      <div class="win-star">üõ∏</div>
      <h2>You survived the lava!</h2>
      <p>All solo levels complete!</p>
      <button onclick="returnToMenu()">‚Ü© Menu</button>
    </div>
  </div>

  <script src="js/main.js"></script>
  <script src="js/sound.js"></script>
  <script>
    // Play fire sound on load, stop on win overlay or navigation
    window.addEventListener('DOMContentLoaded', () => {
      if (typeof playFireSound === 'function') playFireSound();
    });
    function stopFireAndGo(action) {
      if (typeof stopFireSound === 'function') stopFireSound();
      action();
    }
    // Patch menu/next buttons to stop fire sound
    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('button[onclick]').forEach(btn => {
        if (btn.textContent.includes('Menu')) {
          btn.onclick = () => stopFireAndGo(returnToMenu);
        }
      });
    });
    // Stop fire sound when win overlay is shown
    const origShow = document.getElementById('winOverlay').style.display;
    const observer = new MutationObserver(() => {
      if (document.getElementById('winOverlay').style.display === 'flex') {
        if (typeof stopFireSound === 'function') stopFireSound();
      }
    });
    observer.observe(document.getElementById('winOverlay'), { attributes: true, attributeFilter: ['style'] });
  </script>
</body>
</html>
